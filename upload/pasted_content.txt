// frontend/src/EvaluationSummary.jsx

import React, { useState, useEffect } from 'react';
import axios from 'axios';

const API_URL = 'http://localhost:8000/api/v1/evaluation/summary/';

const EvaluationSummary = () => {
    const [summaryData, setSummaryData] = useState([]);
    const [loading, setLoading] = useState(true);

    useEffect(() => {
        const fetchSummary = async () => {
            try {
                const response = await axios.get(API_URL);
                setSummaryData(response.data);
            } catch (error) {
                console.error("è©•ä¾¡ã‚µãƒãƒªãƒ¼ã®å–å¾—ä¸­ã«ã‚¨ãƒ©ãƒ¼:", error);
                setSummaryData([]);
            } finally {
                setLoading(false);
            }
        };

        fetchSummary();
    }, []);

    if (loading) {
        return <div style={{ padding: '20px' }}>è©•ä¾¡ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ãƒ‰ä¸­...</div>;
    }
    
    // ã‚¹ã‚³ã‚¢ã«å¿œã˜ã¦è‰²ã‚’æ±ºå®šã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼
    const getScoreColor = (score) => {
        if (score >= 4.0) return 'green';
        if (score >= 3.0) return 'orange';
        return 'red';
    };

    return (
        <div style={{ padding: '20px', fontFamily: 'Arial, sans-serif', maxWidth: '800px', margin: 'auto' }}>
            <h1>ğŸ“Š è·å“¡ç·åˆè©•ä¾¡ã‚µãƒãƒªãƒ¼</h1>
            <p>å‹¤å‹™å®Ÿç¸¾ï¼ˆè²¢çŒ®åº¦ï¼‰ã¨ç›¸äº’è©•ä¾¡ï¼ˆå”èª¿æ€§ï¼‰ã‚’çµ±åˆã—ãŸè©•ä¾¡ã§ã™ã€‚</p>
            
            <table style={{ width: '100%', borderCollapse: 'collapse', marginTop: '20px' }}>
                <thead>
                    <tr style={{ backgroundColor: '#f4f4f4' }}>
                        <th style={{ padding: '10px', border: '1px solid #ddd', textAlign: 'left' }}>è·å“¡å</th>
                        <th style={{ padding: '10px', border: '1px solid #ddd' }}>è²¢çŒ®åº¦ (FTE)</th>
                        <th style={{ padding: '10px', border: '1px solid #ddd' }}>å”èª¿æ€§ (å¹³å‡ç‚¹)</th>
                        <th style={{ padding: '10px', border: '1px solid #ddd', backgroundColor: '#e0f7fa' }}>ç·åˆã‚¹ã‚³ã‚¢</th>
                    </tr>
                </thead>
                <tbody>
                    {summaryData.map((staff, index) => (
                        <tr key={index} style={{ backgroundColor: index % 2 === 0 ? '#fff' : '#fafafa' }}>
                            <td style={{ padding: '10px', border: '1px solid #ddd' }}>{staff.staff_name}</td>
                            <td style={{ padding: '10px', border: '1px solid #ddd', textAlign: 'center' }}>
                                <span style={{ color: getScoreColor(staff.contribution_score) }}>{staff.contribution_score}</span>
                            </td>
                            <td style={{ padding: '10px', border: '1px solid #ddd', textAlign: 'center' }}>
                                <span style={{ color: getScoreColor(staff.cooperation_score) }}>{staff.cooperation_score}</span>
                            </td>
                            <td style={{ padding: '10px', border: '1px solid #ddd', textAlign: 'center', fontWeight: 'bold' }}>
                                <span style={{ color: getScoreColor(staff.overall_score) }}>{staff.overall_score}</span>
                            </td>
                        </tr>
                    ))}
                </tbody>
            </table>
            
            <p style={{ marginTop: '20px', fontSize: '12px', color: '#666' }}>â€» ç·åˆã‚¹ã‚³ã‚¢ã¯è²¢çŒ®åº¦ 50% ã¨å”èª¿æ€§ 50% ã§è¨ˆç®—ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
        </div>
    );
};

export default EvaluationSummary;
